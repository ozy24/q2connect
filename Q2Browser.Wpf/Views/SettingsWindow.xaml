<Window x:Class="Q2Browser.Wpf.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:converters="clr-namespace:Q2Browser.Wpf.Converters"
        mc:Ignorable="d"
        Title="Settings" Height="730" Width="550"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    <Window.Resources>
        <converters:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
    </Window.Resources>
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Title -->
        <TextBlock Grid.Row="0" Text="Configuration" FontSize="18" FontWeight="Bold" Margin="0,0,0,20"/>

        <!-- Settings Content -->
        <StackPanel Grid.Row="1">
            <!-- Master Server Settings -->
            <GroupBox Header="Master Server" Margin="0,0,0,15">
                <StackPanel Margin="10">
                    <CheckBox Content="Use HTTP Master Server" IsChecked="{Binding UseHttpMasterServer}" Margin="0,0,0,10"/>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10" IsEnabled="{Binding UseHttpMasterServer}">
                        <TextBlock Text="HTTP URL:" Width="120" VerticalAlignment="Center"/>
                        <TextBox Text="{Binding HttpMasterServerUrl}" Width="350" VerticalContentAlignment="Center"/>
                    </StackPanel>
                    <TextBlock Text="UDP Master Server (used if HTTP is disabled):" Margin="0,5,0,5" FontWeight="Bold"/>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Address:" Width="120" VerticalAlignment="Center"/>
                        <TextBox Text="{Binding MasterServerAddress}" Width="250" VerticalContentAlignment="Center" IsEnabled="{Binding UseHttpMasterServer, Converter={StaticResource InverseBooleanConverter}}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Port:" Width="120" VerticalAlignment="Center"/>
                        <TextBox Text="{Binding MasterServerPort}" Width="100" VerticalContentAlignment="Center" IsEnabled="{Binding UseHttpMasterServer, Converter={StaticResource InverseBooleanConverter}}"/>
                    </StackPanel>
                    <CheckBox Content="Enable LAN Broadcast Discovery" IsChecked="{Binding EnableLanBroadcast}" Margin="0,5,0,0"/>
                </StackPanel>
            </GroupBox>

            <!-- Options -->
            <GroupBox Header="Options" Margin="0,0,0,15">
                <StackPanel Margin="10">
                    <CheckBox Content="Portable mode (store settings in application directory)" IsChecked="{Binding PortableMode}" Margin="0,0,0,10"/>
                    <TextBlock Text="When enabled, settings and favorites are stored alongside the executable. When disabled, they are stored in AppData." 
                               FontStyle="Italic" FontSize="10" Foreground="Gray" Margin="0,0,0,10" TextWrapping="Wrap"/>
                    <CheckBox Content="Refresh servers on startup" IsChecked="{Binding RefreshOnStartup}" Margin="0,5,0,0"/>
                </StackPanel>
            </GroupBox>

            <!-- Quake 2 Executable Settings -->
            <GroupBox Header="Quake 2 Executable (quake2.exe, q2pro.exe, r1q2.exe)" Margin="0,0,0,15">
                <StackPanel Margin="10">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Path:" Width="120" VerticalAlignment="Center"/>
                        <TextBox Text="{Binding Q2ExecutablePath}" Width="250" VerticalContentAlignment="Center" IsReadOnly="True"/>
                        <Button Content="Browse..." Command="{Binding BrowseQ2ExecutableCommand}" Width="80" Margin="5,0,0,0"/>
                    </StackPanel>
                </StackPanel>
            </GroupBox>

            <!-- Advanced Settings -->
            <GroupBox Header="Advanced">
                <StackPanel Margin="10">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Max Concurrent Probes:" Width="120" VerticalAlignment="Center"/>
                        <TextBox Text="{Binding MaxConcurrentProbes}" Width="100" VerticalContentAlignment="Center"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Probe Timeout (ms):" Width="120" VerticalAlignment="Center"/>
                        <TextBox Text="{Binding ProbeTimeoutMs}" Width="100" VerticalContentAlignment="Center"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Log Level:" Width="120" VerticalAlignment="Center"/>
                        <ComboBox SelectedValue="{Binding LogLevel}" SelectedValuePath="Content" Width="100" VerticalContentAlignment="Center">
                            <ComboBox.Items>
                                <ComboBoxItem Content="Debug"/>
                                <ComboBoxItem Content="Info"/>
                                <ComboBoxItem Content="Warning"/>
                                <ComboBoxItem Content="Error"/>
                            </ComboBox.Items>
                        </ComboBox>
                        <TextBlock Text="(Controls diagnostic verbosity)" FontStyle="Italic" FontSize="10" Foreground="Gray" 
                                   VerticalAlignment="Center" Margin="10,0,0,0"/>
                    </StackPanel>
                </StackPanel>
            </GroupBox>
        </StackPanel>

        <!-- Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button Content="Save" Command="{Binding SaveCommand}" Width="80" Height="30" IsDefault="True" Click="SaveButton_Click" Margin="0,0,10,0"/>
            <Button Content="Cancel" Command="{Binding CancelCommand}" Width="80" Height="30" IsCancel="True" Click="CancelButton_Click"/>
        </StackPanel>
    </Grid>
</Window>

